<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>data</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            direction: rtl;
            background-image: url(96030454-77b1-4daa-ba19-cf6bf45deb9b.webp);
            background-size: cover; /* لتكبير الصورة لتغطية الشاشة */
            background-position: center; /* لتوسيط الصورة */
        }
        #total {
        }
.overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
}
#message {
        display: none;
        position: fixed;
        width: 80%; /* تكبير عرض النافذة المنبثقة */
        max-width: 800px; /* تحديد أقصى عرض */
        padding: 20px; /* تقليل الحشو */
        border-radius: 10px;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
        z-index: 1000;
}
        #message table {
            width: 100%;
            font-size: 18px; /* تكبير حجم الخط */
            border-collapse: collapse;
            margin-bottom: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        #message img {
          width: 100px; /* تكبير حجم الصورة */
          height: 100px;
        }
         #barcodeImg {
        }
        #message th, #message td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        #message th {
            background-color: #007bff;
            color: white;
        }
        #message button {
            background: #2da62d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }
        input {
          width: 20%;
          padding: 5px;
          box-sizing: border-box;
          border-radius: 5px;
          border: 1px solid #ddd;
          outline: none;
          transition: 0.3s;
        }
        input:focus {
          border-color: #007bff;
          box-shadow: 0 0 10px rgba(0, 123, 255, 0.3);
        }
        #a button {
          background: #007bff;
          color: white;
          border: none;
          margin: 0 10px 0 0;
          padding: 10px 20px;
          border-radius: 25px;
          cursor: pointer;
          transition: 0.3s;
        }
        #number1, #number2 {
          display: flex;
          justify-content: center;
        }
        #number1 h3, #number2  h3 {
          margin: 0 10px;
        }
        #newtasgel, #yes, #no, #yes1, #no1 {
          border: 1px solid #007bff;
          margin: 0 10px 10px 0;
          padding: 10px 20px;
          border-radius: 10px;
          transition: 0.3s;
          }
          .pending {
            background-color: #007bff;
          }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: center;
    }
    th {
        background-color: #007bff;
        color: white;
    }
    td {
      background-color: white;
    }
    .control button, #aaa1, #aaa2 {
      padding: 5px 10px;
      margin: 2px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      flex-wrap: wrap;
    }
    #aa {
      width:;
      padding: 8px;
      box-sizing: border-box;
      border-radius: 5px;
      border: 1px solid #ddd;
      outline: none;
      transition: 0.3s;
    }
    #aa:hover {
      border-color: #007bff;
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.3);
    }
    .tanbeh p {
      color: red;
    }
    #user {
            font-size: 20px;
            margin: 10px 0;
            padding: 10px;
            border-radius: 0;
        }
    #user.pending {
            background-color: #ffcc00; /* لون أصفر للبيانات قيد التعديل */
        }
    #user.reviewed {
            background-color: #4CAF50; /* لون أخضر للبيانات التي تمت مراجعتها */
            color: white;
        }
    #user.urgent {
            background-color: #f44336; /* لون أحمر للبيانات العاجلة */
            color: white;
        }
        .amr {
          user-select: none;
          display: flex;
          justify-content: center;
          margin-top: 5px;
        }
    </style>
</head>
<body>
<div id="total">
<div id="a">
    <input type="number" id="maxRegistrationsInput" placeholder="عدد المسجلين المطلوب" required>
    <button onclick="setMaxRegistrations()">تعيين</button>
    <input type="text" id="barcodeInput" placeholder="ادخل الباركود هنا" required>
    <input type="number" id="idInput" placeholder="ادخل الرقم القومى هنا" oninput="checkLength(this, 14)" required>
    <button onclick="searchID()">بحث</button>
    <input type="number" id="phoneInput" placeholder="ادخل رقم الموبايل هنا" oninput="checkLength(this,11)" required>
    <button onclick="searchPhone()">بحث</button>
</div>
<div class="tanbeh">
  <p>*لن يتم فتح التسجيل الا عند وضع عدد محدد للتسجيل.</p>
  <p></p>
  <p></p>
</div>
<h2>المسجلين</h2>
<div id="number1">
<h3 id="numberData"></h3>
<h3 id="numberData1"></h3>
<h3 id="numberData2"></h3>
</div>
<div id="number2">
<h3 id="numberData11"></h3>
<h3 id="numberData12"></h3>
</div>
<button id="newtasgel" onclick="newTasgel()">تسجيل جديد</button>
<button id="yes" onclick="yeS()">مقبول</button>
<button id="no" onclick="nO()">مرفوض</button>
<button id="yes1" onclick="yeS1()">الحاضرين</button>
<button id="no1" onclick="nO1()">غير موجودين</button>
<hr>
<table id="dataTable">
    <thead>
        <tr>
            <th>#</th>
            <th>التحكم</th>
            <th>وقت التسجيل</th>
            <th>حالة المسجل</th>
            <th>الباركود</th>
            <th>الصورة الشخصية</th>
            <th>رقم المقعد</th>
            <th>email</th>
            <th>الاسم</th>
            <th>الرقم القومى</th>
            <th>رقم الموبايل</th>
            <th colspan="2">حالة صحة البيانات</th>
        </tr>
    </thead>
    <tbody>
        <!-- البيانات ستظهر هنا -->
    </tbody>
</table>
<table id="dataTable1">
    <thead>
        <tr>
            <th>#</th>
            <th>التحكم</th>
            <th>وقت التسجيل</th>
            <th>حالة المسجل</th>
            <th>الباركود</th> 
            <th>الصورة الشخصية</th>
            <th>رقم المقعد</th>
            <th>email</th>
            <th>الاسم</th>
            <th>الرقم القومى</th>
            <th>رقم الموبايل</th>
            <th colspan="2">حالة صحة البيانات</th>
        </tr>
    </thead>
    <tbody>
        <!-- البيانات ستظهر هنا -->
    </tbody>
</table>
<table id="dataTable2">
    <thead>
        <tr>
            <th>#</th>
            <th>التحكم</th>
            <th>وقت التسجيل</th>
            <th>حالة المسجل</th>
            <th>الباركود</th>
            <th>الصورة الشخصية</th>
            <th>رقم المقعد</th>
            <th>email</th>
            <th>الاسم</th>
            <th>الرقم القومى</th>
            <th>رقم الموبايل</th>
            <th colspan="2">حالة صحة البيانات</th>
        </tr>
    </thead>
    <tbody>
        <!-- البيانات ستظهر هنا -->
    </tbody>
</table>
<table id="dataTable3">
    <thead>
        <tr>
            <th>#</th>
            <th>وقت التسجيل</th>
            <th>حالة المسجل</th>
            <th>الباركود</th>
            <th>الصورة الشخصية</th>
            <th>رقم المقعد</th>
            <th>email</th>
            <th>الاسم</th>
            <th>الرقم القومى</th>
            <th>رقم الموبايل</th>
            <th colspan="2">حالة صحة البيانات</th>
        </tr>
    </thead>
    <tbody>
        <!-- البيانات ستظهر هنا -->
    </tbody>
</table>
<table id="dataTable4">
    <thead>
        <tr>
            <th>#</th>
            <th>وقت التسجيل</th>
            <th>حالة المسجل</th>
            <th>الباركود</th>
            <th>الصورة الشخصية</th>
            <th>رقم المقعد</th>
            <th>email</th>
            <th>الاسم</th>
            <th>الرقم القومى</th>
            <th>رقم الموبايل</th>
            <th colspan="2">حالة صحة البيانات</th>
        </tr>
    </thead>
    <tbody>
        <!-- البيانات ستظهر هنا -->
    </tbody>
</table>
<div id="message">
    <table>
        <thead>
            <tr>
                <th colspan="2">الصورة الشخصية</th>
                <th colspan="2">barcode</th>
            </tr>
            <tr>
                <td colspan="2"><img id="profileImage" src="" alt="Profile" width="50"></td>
                <td colspan="2" id="barcodeImg"></td>
            </tr>
            <tr>
                <th>#</th>
                <th>وقت التسجيل</th>
                <th>رقم المقعد</th>
                <th>email</th>
            </tr>
            <tr>
                <td id="numberindata"></td>
                <td id="timeintasgel"></td>
                <td id="numberintasgel"></td>
                <td id="emailData"></td>
            </tr>
            <tr>
                <th colspan="2">الاسم</th>
                <th>الرقم القومى</th>
                <th>رقم الموبايل</th>
            </tr>
            <tr>
                <td colspan="2" id="profileName"></td>
                <td id="idData"></td>
                <td id="phoneData"></td>
            </tr>
            <tr>
                <th colspan="4">الحالات</th>
            </tr>
            <tr>
                <td colspan="2" id="status1"></td>
                <td colspan="2" id="user"></td>
            </tr>
        </thead>
    </table>
    <button id="aaa">دخل القاعة</button>
    <button id="close" onclick="Close()">إغلاق</button>
</div>
<div class="overlay" id="overlay"></div>
<div class="amr" dir="rtl">
  <p>
    #المهندس_عمرو_بن_الشيخ_مروان
  </p>
</div>
</div>
<script>
        // Function to load data from server
        async function loadData() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error('فشل في تحميل البيانات');
                }

                // Update counts
                updateCounts(data);
                
                // Update tables
                updateTables(data);
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Function to update counts display
        function updateCounts(data) {
            let a = 0; // Approved
            let a1 = 0; // Rejected
            let a2 = 0; // Present
            let a3 = 0; // Left
            let a4 = 0; // Not checked in

            data.forEach(item => {
                if (item.a === 0) a++;
                if (item.a === 1) a1++;
                if (item.status === 'دخل القاعة') a2++;
                if (item.status === 'خرج من القاعة') a3++;
                if (!item.status) a4++;
            });

            document.getElementById("numberData").textContent = "عدد المسجلين: " + data.length;
            document.getElementById("numberData1").textContent = "عدد المقبولين: " + a;
            document.getElementById("numberData2").textContent = "عدد المرفوضين: " + a1;
            document.getElementById("numberData11").textContent = "عدد الحاضرين: " + a2;
            document.getElementById("numberData12").textContent = "عدد الغير موجودين: " + (a3 + a4);
        }

        // Function to update tables
        function updateTables(data) {
            const tables = {
                dataTable: item => item.a === -1,
                dataTable1: item => item.a === 0,
                dataTable2: item => item.a === 1,
                dataTable3: item => item.status === 'دخل القاعة',
                dataTable4: item => item.status === 'خرج من القاعة' || !item.status
            };

            // Clear all tables first
            Object.keys(tables).forEach(tableId => {
                const table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
                table.innerHTML = '';
            });

            // Populate tables
            data.forEach((item, index) => {
                Object.entries(tables).forEach(([tableId, filterFn]) => {
                    if (filterFn(item)) {
                        const table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
                        const newRow = table.insertRow();
                        
                        // Common columns
                        let rowContent = `
                            <td>${index + 1}</td>
                            <td><button id="aa">${item.timeTasgel}</button></td>
                            <td><button id="aa">${item.status ? item.status + ': ' + item.timestamp : ''}</button></td>
                            <td id="barcode-${tableId}-${index}"></td>
                            <td><img src="${item.imageUrl}" alt="Profile" width="50"></td>
                            <td><button id="aa">${index + 1}</button></td>
                            <td><button id="aa">${item.useremail}</button></td>
                            <td><button id="aa">${item.name}</button></td>
                            <td><button id="aa">${item.id}</button></td>
                            <td><button id="aa">${item.phone}</button></td>
                            <td><button id="aa">${item.a}</button></td>
                        `;

                        // Add control buttons based on table
                        if (tableId === 'dataTable') {
                            rowContent = `
                                <td>${index + 1}</td>
                                <td class="control">
                                    <button onclick="removeRow(${item.tasgel})">-</button>
                                </td>
                                ${rowContent}
                                <td>
                                    <button id="aaa1" onclick="approveRegistration(${item.tasgel})">✅</button>
                                    <button id="aaa2" onclick="rejectRegistration(${item.tasgel})">❌</button>
                                </td>
                            `;
                        } else if (tableId === 'dataTable1') {
                            rowContent = `
                                <td>${index + 1}</td>
                                <td class="control">
                                    <button onclick="removeRow(${item.tasgel})">-</button>
                                </td>
                                ${rowContent}
                                <td>
                                    <button id="aaa2" onclick="rejectRegistration(${item.tasgel})">❌</button>
                                </td>
                            `;
                        } else if (tableId === 'dataTable2') {
                            rowContent = `
                                <td>${index + 1}</td>
                                <td class="control">
                                    <button onclick="removeRow(${item.tasgel})">-</button>
                                </td>
                                ${rowContent}
                                <td>
                                    <button id="aaa1" onclick="approveRegistration(${item.tasgel})">✅</button>
                                </td>
                            `;
                        }

                        newRow.innerHTML = rowContent;

                        // Generate QR code
                        const barcodeDiv = document.getElementById(`barcode-${tableId}-${index}`);
                        barcodeDiv.innerHTML = '';
                        new QRCode(barcodeDiv, {
                            text: `Email: ${item.useremail}, Name: ${item.name}, ID: ${item.id}, Phone: ${item.phone}`,
                            width: 120,
                            height: 120
                        });
                    }
                });
            });
        }

        // Function to set max registrations
        async function setMaxRegistrations() {
            const maxRegistrations = document.getElementById('maxRegistrationsInput').value;
            
            if (!maxRegistrations) {
                alert('يرجى إدخال عدد المسجلين المطلوب');
                return;
            }

            try {
                const response = await fetch('/api/max-registrations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ maxRegistrations })
                });

                if (!response.ok) {
                    const result = await response.json();
                    throw new Error(result.error || 'فشل في تعيين الحد الأقصى');
                }

                alert(`تم تعيين الحد الأقصى للمسجلين إلى ${maxRegistrations}`);
                document.getElementById('maxRegistrationsInput').value = maxRegistrations;
            } catch (error) {
                alert(error.message);
            }
        }

        // Function to remove a row
        async function removeRow(tasgel) {
            if (!confirm('هل أنت متأكد من حذف هذا التسجيل؟')) return;
            
            try {
                const response = await fetch(`/api/data/${tasgel}`, {
                    method: 'DELETE'
                });

                if (!response.ok) {
                    const result = await response.json();
                    throw new Error(result.error || 'فشل في حذف البيانات');
                }

                loadData(); // Refresh the table
            } catch (error) {
                alert(error.message);
            }
        }

        // Function to approve registration
        async function approveRegistration(tasgel) {
            try {
                const response = await fetch(`/api/data/${tasgel}/status`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status: 0 })
                });

                if (!response.ok) {
                    const result = await response.json();
                    throw new Error(result.error || 'فشل في الموافقة على التسجيل');
                }

                loadData(); // Refresh the table
            } catch (error) {
                alert(error.message);
            }
        }

        // Function to reject registration
        async function rejectRegistration(tasgel) {
            try {
                const response = await fetch(`/api/data/${tasgel}/status`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status: 1 })
                });

                if (!response.ok) {
                    const result = await response.json();
                    throw new Error(result.error || 'فشل في رفض التسجيل');
                }

                loadData(); // Refresh the table
            } catch (error) {
                alert(error.message);
            }
        }

        // Function to handle barcode scanning
        async function scanBarcode() {
            const barcodeInput = document.getElementById('barcodeInput');
            const overlay = document.getElementById('overlay');
            const message = document.getElementById('message');
            const enterButton = document.getElementById('aaa');

            barcodeInput.addEventListener('input', async function(event) {
                const barcode = event.target.value;
                if (!barcode) return;

                // Parse barcode data
                const parsedData = parseBarcode(barcode);
                if (!parsedData.id) {
                    alert('باركود غير صالح');
                    barcodeInput.value = "";
                    barcodeInput.click();
                    return;
                }

                try {
                    // Find matching registration
                    const response = await fetch('/api/data');
                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error('فشل في تحميل البيانات');
                    }

                    const matchedData = data.find(item => item.id === parsedData.id);
                    if (!matchedData) {
                        alert('البيانات غير موجودة في النظام');
                        barcodeInput.value = "";
                        barcodeInput.click();
                        return;
                    }

                    // Update message popup with matched data
                    updateMessagePopup(matchedData, data);

                    // Show the popup
                    message.style.display = 'block';
                    overlay.style.display = 'block';

                    // Set enter/exit button handler
                    enterButton.onclick = async function() {
                        const newStatus = matchedData.status === 'دخل القاعة' ? 
                            'خرج من القاعة' : 'دخل القاعة';
                        
                        try {
                            const response = await fetch(`/api/data/${matchedData.tasgel}/attendance`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ status: newStatus })
                            });

                            if (!response.ok) {
                                const result = await response.json();
                                throw new Error(result.error || 'فشل في تحديث الحضور');
                            }

                            // Close popup and refresh
                            Close();
                            loadData();
                        } catch (error) {
                            alert(error.message);
                        }
                    };
                } catch (error) {
                    alert(error.message);
                    barcodeInput.value = "";
                    barcodeInput.click();
                }
            });
        }

        // Function to update message popup with registration data
        function updateMessagePopup(data, allData) {
            // Update profile image
            document.getElementById('profileImage').src = data.imageUrl;
            
            // Update QR code
            const barcodeImg = document.getElementById('barcodeImg');
            barcodeImg.innerHTML = '';
            new QRCode(barcodeImg, {
                text: `Email: ${data.useremail}, Name: ${data.name}, ID: ${data.id}, Phone: ${data.phone}`,
                width: 120,
                height: 120
            });
            
            // Update other fields
            document.getElementById('emailData').textContent = data.useremail;
            document.getElementById('profileName').textContent = data.name;
            document.getElementById('timeintasgel').textContent = data.timeTasgel;
            
            const rowIndex = allData.findIndex(item => item.tasgel === data.tasgel) + 1;
            document.getElementById('numberindata').textContent = rowIndex;
            document.getElementById('numberintasgel').textContent = rowIndex;
            
            // Update status message
            const user = document.getElementById('user');
            if (data.a === -1) {
                user.textContent = `لم يتم مراجعة البيانات بعد.`;
                user.className = 'pending';
            } else if (data.a === 0) {
                user.textContent = `تم مراجعة البيانات، وتم الموافقة على تسجيله.`;
                user.className = 'reviewed';
            } else if (data.a === 1) {
                user.textContent = `البيانات مرفوضة، ويجب تعديل البيانات في أسرع وقت.`;
                user.className = 'urgent';
            }

            // Update ID and phone
            document.getElementById('idData').textContent = data.id;
            document.getElementById('phoneData').textContent = data.phone;

            // Update attendance status
            const status1 = document.getElementById('status1');
            const enterButton = document.getElementById('aaa');
            
            if (data.status === 'دخل القاعة') {
                status1.textContent = `دخل القاعة في: ${data.timestamp}`;
                enterButton.textContent = 'خروج من القاعة';
            } else {
                status1.textContent = `خرج من القاعة في: ${data.timestamp || 'لم يدخل بعد'}`;
                enterButton.textContent = 'دخل القاعة';
            }
        }

        // Function to close popup
        function Close() {
            document.getElementById('message').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('barcodeInput').value = "";
            document.getElementById('barcodeInput').click();
        }

        // Function to parse barcode data
        function parseBarcode(barcode) {
            const data = {};
            const parts = barcode.split(', ');
            
            parts.forEach(part => {
                const [key, value] = part.split(': ');
                if (key === 'Email') data.useremail = value;
                if (key === 'Name') data.name = value;
                if (key === 'ID') data.id = value;
                if (key === 'Phone') data.phone = value;
            });
            
            return data;
        }

        // Function to search by ID
        async function searchID() {
            const idInput = document.getElementById('idInput').value;
            if (!idInput) return;

            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error('فشل في تحميل البيانات');
                }

                const matchedData = data.find(item => item.id === idInput);
                if (!matchedData) {
                    alert('البيانات غير موجودة في النظام');
                    return;
                }

                // Update and show message popup
                updateMessagePopup(matchedData, data);
                document.getElementById('message').style.display = 'block';
                document.getElementById('overlay').style.display = 'block';

                // Set enter/exit button handler
                document.getElementById('aaa').onclick = async function() {
                    const newStatus = matchedData.status === 'دخل القاعة' ? 
                        'خرج من القاعة' : 'دخل القاعة';
                    
                    try {
                        const response = await fetch(`/api/data/${matchedData.tasgel}/attendance`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ status: newStatus })
                        });

                        if (!response.ok) {
                            const result = await response.json();
                            throw new Error(result.error || 'فشل في تحديث الحضور');
                        }

                        // Close popup and refresh
                        Close();
                        loadData();
                    } catch (error) {
                        alert(error.message);
                    }
                };
            } catch (error) {
                alert(error.message);
            }
        }

        // Function to search by phone
        async function searchPhone() {
            const phoneInput = document.getElementById('phoneInput').value;
            if (!phoneInput) return;

            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error('فشل في تحميل البيانات');
                }

                const matchedData = data.find(item => item.phone === phoneInput);
                if (!matchedData) {
                    alert('البيانات غير موجودة في النظام');
                    return;
                }

                // Update and show message popup
                updateMessagePopup(matchedData, data);
                document.getElementById('message').style.display = 'block';
                document.getElementById('overlay').style.display = 'block';

                // Set enter/exit button handler
                document.getElementById('aaa').onclick = async function() {
                    const newStatus = matchedData.status === 'دخل القاعة' ? 
                        'خرج من القاعة' : 'دخل القاعة';
                    
                    try {
                        const response = await fetch(`/api/data/${matchedData.tasgel}/attendance`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ status: newStatus })
                        });

                        if (!response.ok) {
                            const result = await response.json();
                            throw new Error(result.error || 'فشل في تحديث الحضور');
                        }

                        // Close popup and refresh
                        Close();
                        loadData();
                    } catch (error) {
                        alert(error.message);
                    }
                };
            } catch (error) {
                alert(error.message);
            }
        }

        // Initialize on page load
        window.onload = async function() {
            // Load initial data
            await loadData();
            
            // Initialize barcode scanner
            scanBarcode();
            
            // Load max registrations value
            try {
                const response = await fetch('/api/max-registrations');
                const result = await response.json();
                
                if (response.ok && result.maxRegistrations) {
                    document.getElementById('maxRegistrationsInput').value = result.maxRegistrations;
                }
            } catch (error) {
                console.error('Error loading max registrations:', error);
            }
        };

        // Keyboard shortcuts
        document.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                const activeElement = document.activeElement;
                if (activeElement.id === "barcodeInput") {
                    // Let the barcode scanner handle it
                } else if (activeElement.id === "maxRegistrationsInput") {
                    setMaxRegistrations();
                } else if (activeElement.id === "idInput") {
                    searchID();
                } else if (activeElement.id === "phoneInput") {
                    searchPhone();
                } else if (activeElement.id === "aaa") {
                    document.getElementById("aaa").click();
                }
            }
        });
</script>
</body>
</html>
